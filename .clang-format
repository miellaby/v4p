# V4P Modern C Code Formatting Style
# Updated: 2026 - Modern C (C17) Standards

# Base Configuration - Modern C Standards
BasedOnStyle: WebKit
Language: Cpp  # Best C compatibility
Standard: c++17
IndentWidth: 4
TabWidth: 4
UseTab: Never
# ColumnLimit: 80

# Brace Style - Modern K&R (Most common in C)
BreakBeforeBraces: Custom
BraceWrapping:
  AfterFunction: false      # function() {
  AfterControlStatement: false  # if () {
  AfterStruct: false        # struct {
  AfterEnum: false         # enum {
  AfterUnion: false        # union {
  AfterExternBlock: false  # extern {
  BeforeCatch: false       # (C++ only)
  BeforeElse: false        # } else {
  IndentBraces: false
  SplitEmptyFunction: false
  SplitEmptyRecord: false
  SplitEmptyNamespace: false

# Spacing - Modern C Readability Standards
SpaceBeforeParens: ControlStatements
SpaceAfterCStyleCast: true
SpacesInParentheses: false
SpacesInSquareBrackets: false
SpacesInContainerLiterals: false
SpaceBeforeSquareBrackets: false

# Pointer/Reference Alignment - C Standard (Type *pointer)
PointerAlignment: Left
ReferenceAlignment: Left
DerivePointerAlignment: false

# Function Formatting - More Compact
AllowAllParametersOfDeclarationOnNextLine: true
BinPackParameters: true
BinPackArguments: true
AllowShortFunctionsOnASingleLine: Empty
AllowShortIfStatementsOnASingleLine: WithoutElse
AllowShortLoopsOnASingleLine: true

# Indentation - Modern Standards
IndentCaseLabels: true
IndentCaseBlocks: true
IndentGotoLabels: true
IndentPPDirectives: BeforeHash
IndentExternBlock: NoIndent

# Comment Formatting - Modern Standards
SpacesBeforeTrailingComments: 2
CommentPragmas: '^ IWYU pragma:|^ TODO:|^ FIXME:'
FixNamespaceComments: false

# Line Breaking - More Conservative (Prevent excessive breaking)
PenaltyBreakBeforeFirstCallParameter: 10000  # Much higher = much less likely to break
PenaltyBreakComment: 500
PenaltyBreakString: 10000
PenaltyBreakTemplateDeclaration: 10000
PenaltyExcessCharacter: 1000000
PenaltyReturnTypeOnItsOwnLine: 10000
PenaltyIndentedWhitespace: 0

# Alignment - Conservative C Standards (Fixed)
AlignConsecutiveMacros: None
AlignConsecutiveAssignments: None
# AlignConsecutiveDeclarations: None
AlignEscapedNewlines: DontAlign
AlignOperands: DontAlign
AlignTrailingComments: false

# Whitespace - Modern Standards
KeepEmptyLinesAtTheStartOfBlocks: false
MaxEmptyLinesToKeep: 1
PackConstructorInitializers: Never
ConstructorInitializerAllOnOneLineOrOnePerLine: false

# Includes and Sorting
SortIncludes: Never  # Preserve manual include order
SortUsingDeclarations: false

# C-Specific Optimizations (More compact)
ContinuationIndentWidth: 4

# Function signature formatting - more compact
ColumnLimit: 120  # Allow longer lines for function signatures
PenaltyBreakFirstLessLess: 1000

# Better function parameter handling
AlignAfterOpenBracket: Align

# V4P Specific Adjustments
SpaceAfterLogicalNot: true  # Modern C standard
SpaceBeforeAssignmentOperators: true
SpaceBeforeCtorInitializerColon: false  # C doesn't have constructors
SpaceBeforeInheritanceColon: false     # C doesn't have inheritance

# Disable C++ specific features
Cpp11BracedListStyle: false
