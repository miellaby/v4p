# V4P Modern C Code Formatting Style
# Updated: 2026 - Modern C (C17) Standards

# Base Configuration - Modern C Standards
BasedOnStyle: WebKit
Language: Cpp  # Best C compatibility
Standard: c++17
IndentWidth: 4
TabWidth: 4
UseTab: Never
# ColumnLimit: 80

# Brace Style - Modern K&R (Most common in C)
BreakBeforeBraces: Custom
BraceWrapping:
  AfterFunction: false      # function() {
  AfterControlStatement: false  # if () {
  AfterStruct: false        # struct {
  AfterEnum: false         # enum {
  AfterUnion: false        # union {
  AfterExternBlock: false  # extern {
  BeforeCatch: false       # (C++ only)
  BeforeElse: false        # } else {
  IndentBraces: false
  SplitEmptyFunction: false
  SplitEmptyRecord: false
  SplitEmptyNamespace: false

# Spacing - Modern C Readability Standards
SpaceBeforeParens: ControlStatements
SpaceAfterCStyleCast: true
SpacesInParentheses: false
SpacesInSquareBrackets: false
SpacesInContainerLiterals: false
SpaceBeforeSquareBrackets: false

# Pointer/Reference Alignment - C Standard (Type *pointer)
PointerAlignment: Left
ReferenceAlignment: Left
DerivePointerAlignment: false

# Function Formatting - Modern C Standards
# AllowAllParametersOfDeclarationOnNextLine: true
# BinPackParameters: false
# BinPackArguments: false
# AlignConsecutiveDeclarations: true
# AlignConsecutiveAssignments: true
AllowShortFunctionsOnASingleLine: None
AllowShortIfStatementsOnASingleLine: false
AllowShortLoopsOnASingleLine: false

# Indentation - Modern Standards
IndentCaseLabels: true
IndentCaseBlocks: true
IndentGotoLabels: true
IndentPPDirectives: BeforeHash
IndentExternBlock: NoIndent

# Comment Formatting - Modern Standards
SpacesBeforeTrailingComments: 2
CommentPragmas: '^ IWYU pragma:|^ TODO:|^ FIXME:'
FixNamespaceComments: false

# Line Breaking - Conservative (Fixed to prevent excessive breaking)
PenaltyBreakBeforeFirstCallParameter: 1000  # Higher = less likely to break
PenaltyBreakComment: 300
# PenaltyBreakFirstLessLess: 1000
PenaltyBreakString: 1000
PenaltyBreakTemplateDeclaration: 1000
PenaltyExcessCharacter: 1000000
PenaltyReturnTypeOnItsOwnLine: 1000
PenaltyIndentedWhitespace: 0

# Alignment - Conservative C Standards (Fixed)
AlignConsecutiveMacros: None
AlignConsecutiveAssignments: None
# AlignConsecutiveDeclarations: None
AlignEscapedNewlines: DontAlign
AlignOperands: DontAlign
AlignTrailingComments: false

# Whitespace - Modern Standards
KeepEmptyLinesAtTheStartOfBlocks: false
MaxEmptyLinesToKeep: 1
PackConstructorInitializers: Never
ConstructorInitializerAllOnOneLineOrOnePerLine: false

# Includes and Sorting
SortIncludes: Never  # Preserve manual include order
SortUsingDeclarations: false

# C-Specific Optimizations (Fixed for better function signatures)
AllowAllArgumentsOnNextLine: true
AllowAllParametersOfDeclarationOnNextLine: false
ContinuationIndentWidth: 4
BinPackArguments: false

# Function signature formatting - keep parameters compact
BinPackParameters: false
ColumnLimit: 100  # Allow longer lines for function signatures
PenaltyBreakFirstLessLess: 1000

# Better function parameter handling
AlignAfterOpenBracket: Align
AlignConsecutiveDeclarations: false

# V4P Specific Adjustments
SpaceAfterLogicalNot: true  # Modern C standard
SpaceBeforeAssignmentOperators: true
SpaceBeforeCtorInitializerColon: false  # C doesn't have constructors
SpaceBeforeInheritanceColon: false     # C doesn't have inheritance

# Disable C++ specific features
Cpp11BracedListStyle: false
